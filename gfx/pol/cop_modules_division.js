class DivisionCOP extends COPModules{constructor(i={}){super(i),this.showLabel=!1}async changeDivision(i){const e=document.querySelector(`.${this.prefix}`);e?.classList.add("--loading-division");const t="turn_on"===i;await super.fetchData({data:this.queries.DIVISION(t),linkParameter:`?mutation=copModulesDivision&type=${this.type}`}),this.callbacks.afterDivision?.()}label(){const i=this.divisionElement.querySelector(`.${this.prefix}_division__label`);i&&(this.showLabel||i.parentNode.removeChild(i))}text(){const i=this.vars.division?this.divisionElement.querySelector(`.${this.prefix}_division__text.--off`):this.divisionElement.querySelector(`.${this.prefix}_division__text.--on`);i&&i.parentNode.removeChild(i)}selection(){const i=this.vars.division?this.divisionElement.querySelector(`#${this.prefix}_division_turn_on`):this.divisionElement.querySelector(`#${this.prefix}_division_turn_off`);i&&(i.checked=!0)}afterCloseDivisionModal(){const i=this.divisionElement.getAttribute("data-division"),e=this.divisionElement.querySelector(`.${this.prefix}_division__input[value="${i}"]`);e&&(e.checked=!0,this.divisionElement.querySelector(`.${this.prefix}_division__change`)?.focus())}setWcagAttributes(i){i.querySelector(".cop_division__selection")?.setAttribute("aria-hidden","true"),i.querySelector(".cop_division__selection")?.querySelectorAll("a, input")?.forEach((i=>{i.setAttribute("tabindex","-1")}))}removeWcagAttributes(i){i.querySelector(".cop_division__selection")?.removeAttribute("aria-hidden"),i.querySelector(".cop_division__selection")?.querySelectorAll("a, input")?.forEach((i=>{i.removeAttribute("tabindex")}))}onClickShowSelection(){this.divisionElement.classList.toggle("--show-selection"),this.removeWcagAttributes(this.divisionElement)}onClickHideSelection(){this.divisionElement.classList.remove("--show-selection"),this.setWcagAttributes(this.divisionElement)}onChangeShowConfirmation(i){const e=this.divisionElement.querySelector(`.${this.prefix}_division__confirmation`);if(e){if(this.vars.modal=new Modal({element:e,afterClose:this.afterCloseDivisionModal.bind(this),setFocusOnFirstElement:!0,classList:"--division__confirmation",afterShow:()=>{document.querySelector(".modal.--division__confirmation").setAttribute("aria-label",this.txt["Zmiana opcji wysyłki zamówienia"])}}),"turn_on"===i.value)return e.classList.remove("--off"),void e.classList.add("--on");e.classList.remove("--on"),e.classList.add("--off")}}onClickCancelChangeDivision(){this.vars.modal&&this.vars.modal.closeModal()}onClickConfirmChangeDivision(){this.divisionElement.classList.remove("--show-selection");const i=this.divisionElement.querySelector(`.${this.prefix}_division__input:checked`);if(!i)return;const e=this.divisionElement.getAttribute("data-division"),{value:t}=i;this.vars.modal.closeModal(),e!==t&&this.changeDivision(t)}initEvents(){this.divisionElement.addEventListener("click",(i=>{const{target:e}=i;return e.closest(`.${this.prefix}_division__change`)?(i.preventDefault(),this.onClickShowSelection(),!1):!e.closest(`.${this.prefix}_division__hide_link`)||(i.preventDefault(),this.onClickHideSelection(),!1)})),this.divisionElement.addEventListener("change",(i=>{const{target:e}=i;return!e.closest(`.${this.prefix}_division__input`)||(i.preventDefault(),this.onChangeShowConfirmation(e.closest(`.${this.prefix}_division__input`)),!1)}));const i=this.divisionElement.querySelector(`.${this.prefix}_division__confirmation`);i&&i.addEventListener("click",(i=>{const{target:e}=i;return e.closest(`.${this.prefix}_division__confirmation_button.--cancel`)?(i.preventDefault(),this.onClickCancelChangeDivision(),!1):!e.closest(`.${this.prefix}_division__confirmation_button.--confirm`)||(i.preventDefault(),this.onClickConfirmChangeDivision(),!1)}))}generate(){const i=document.getElementById(`${this.prefix}_division_template`)?.content.cloneNode(!0);if(!i||!i.firstChild)return;const e=this.divisionElement;this.divisionElement=i.firstChild,this.divisionElement.setAttribute("data-division",this.vars.division?"turn_on":"turn_off"),this.label(),this.text(),this.selection(),this.initEvents(),e&&document.body.contains(e)?e.replaceWith(this.divisionElement):super.move({element:this.divisionElement,...this.vars.move})}init(i={}){this.type=i.type||app_shop.vars.copModulesType||"order1",this.vars={division:i.division??this.vars?.division??!1,afterReady:i.afterReady||this.vars?.afterReady||(()=>{}),move:i.move||this.vars?.move||{}},this.callbacks={afterDivision:i.afterDivisionCallback||this.callbacks?.afterDivision||(()=>{})},this.generate(),this.vars.afterReady(this.divisionElement)}}try{app_shop.fn.copModulesDivision=new DivisionCOP,app_shop.vars.copModulesClasses.push((()=>{app_shop.fn.copModulesDivision=new DivisionCOP}))}catch(i){window?.errorLog?.(i)}
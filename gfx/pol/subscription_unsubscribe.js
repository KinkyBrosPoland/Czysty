class SubscrUnsubscribe extends Subscr{constructor(t={}){super(t)}async changeStatus(t=this.statuses.active){this.vars.modal.element?.closest(".modal")?.classList.add("--loading");const s=await super.fetchData({data:this.queries.CHANGE_STATUS(this.vars.subscrId,t),linkParameter:`?mutationy=subscriptionChangeStatus&status=${t}`}),{status:e}=s?.data?.changeSubscriptionStatus||{};"success"===e?this.callbacks.afterChangeStatus?.():this.vars.modal.closeModal()}getTerminateModalElement(){const t=document.getElementById(`${this.prefix}_terminate_confirm_template`)?.content.cloneNode(!0);return!(!t||!t.firstChild)&&(this.termianteModalElement=t.firstChild,this.termianteModalElement)}getSuspendModalElement(){const t=document.getElementById(`${this.prefix}_suspend_confirm_template`)?.content.cloneNode(!0);return!(!t||!t.firstChild)&&(this.suspendModalElement=t.firstChild,this.suspendModalElement)}initTermianteConfirmEvents(){this.termianteModalElement.addEventListener("click",(t=>{const{target:s}=t;if(s.closest(`.${this.prefix}_terminate_confirm__button.--return`))return t.preventDefault(),void this.vars.modal.closeModal();s.closest(`.${this.prefix}_terminate_confirm__button.--edit`)&&this.changeStatus(this.statuses.finished)}))}initSuspendConfirmEvents(){this.suspendModalElement.addEventListener("click",(t=>{const{target:s}=t;s.closest(`.${this.prefix}_suspend_confirm__button.--return`)?this.vars.modal.closeModal():s.closest(`.${this.prefix}_suspend_confirm__button.--edit`)&&this.changeStatus(this.statuses.hold)}))}onClickShowTerminateConfirm(){const t=this.getTerminateModalElement();t&&(this.vars.modal=new Modal({element:t,classList:"--subscr --confirm --terminate --mobile"}),this.initTermianteConfirmEvents())}onClickShowSuspendConfirm(){const t=this.getSuspendModalElement();t&&(this.vars.modal=new Modal({element:t,classList:"--subscr --confirm --suspend --mobile"}),this.initSuspendConfirmEvents())}initEvents(){this.unsubscribeElement.addEventListener("click",(t=>{const{target:s}=t;if(s.closest(`.${this.prefix}_unsubscribe__link.--terminate`))return t.preventDefault(),void this.onClickShowTerminateConfirm();s.closest(`.${this.prefix}_unsubscribe__link.--suspend`)&&(t.preventDefault(),this.onClickShowSuspendConfirm())}))}async generate(){const t=document.getElementById(`${this.prefix}_unsubscribe_template`)?.content.cloneNode(!0);if(!t||!t.firstChild)return;const s=this.unsubscribeElement;if(this.unsubscribeElement=t.firstChild,this.vars.status===this.statuses.finished)return document.querySelector(this.vars.move.moveSelector)?.remove(),void s?.remove();this.vars.status!==this.statuses.hold&&this.vars.canCustomerHoldOffSubscription||this.unsubscribeElement.querySelector(`.${this.prefix}_unsubscribe__link.--suspend`)?.remove(),this.initEvents(),s&&document.body.contains(s)?s.replaceWith(this.unsubscribeElement):super.move({element:this.unsubscribeElement,...this.vars.move})}async init(t={}){this.vars={afterReady:t.afterReady||(()=>{}),move:t.move||this.vars?.move||{},subscrId:t.subscrId||this.vars?.subscrId||null,status:t.status||this.vars?.status||this.statuses.active,canCustomerHoldOffSubscription:t.canCustomerHoldOffSubscription??this.vars?.canCustomerHoldOffSubscription??!0},this.callbacks={afterChangeStatus:t.afterChangeStatusCallback||this.callbacks?.afterChangeStatus},await this.generate(),this.vars.afterReady(this.unsubscribeElement)}}app_shop.fn.subscrUnsubscribe=new SubscrUnsubscribe;
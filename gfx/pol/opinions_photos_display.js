!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.MagicGrid=e()}(this,(function(){"use strict";var t=function(t){if(!t)throw new Error("No config object has been provided.");"boolean"!=typeof t.useTransform&&(t.useTransform=!0),"number"!=typeof t.gutter&&(t.gutter=25),t.container||e("container"),t.items||t.static||e("items or static")},e=function(t){throw new Error("Missing property '"+t+"' in MagicGrid config")},i=function(e){t(e),e.container instanceof HTMLElement?(this.container=e.container,this.containerClass=e.container.className):(this.containerClass=e.container,this.container=document.querySelector(e.container)),this.items=this.container.children,this.static=e.static||!1,this.size=e.items,this.gutter=e.gutter,this.maxColumns=e.maxColumns||!1,this.useMin=e.useMin||!1,this.useTransform=e.useTransform,this.animate=e.animate||!1,this.started=!1,this.init()};return i.prototype.init=function(){if(this.ready()&&!this.started){this.container.style.position="relative";for(var t=0;t<this.items.length;t++){var e=this.items[t].style;e.position="absolute",this.animate&&(e.transition=(this.useTransform?"transform":"top, left")+" 0.2s ease")}this.started=!0}},i.prototype.colWidth=function(){return this.items[0].getBoundingClientRect().width+this.gutter},i.prototype.setup=function(){var t=this.container.getBoundingClientRect().width,e=this.colWidth(),i=Math.floor(t/e)||1,n=[];this.maxColumns&&i>this.maxColumns&&(i=this.maxColumns);for(var s=0;s<i;s++)n[s]={height:0,index:s};return{cols:n,wSpace:t-i*e+this.gutter}},i.prototype.nextCol=function(t,e){return this.useMin?function(t){var e=t[0];for(var i of t)i.height<e.height&&(e=i);return e}(t):t[e%t.length]},i.prototype.positionItems=function(){var t=this.setup(),e=t.cols,i=t.wSpace,n=0,s=this.colWidth();i=Math.floor(i/2);for(var o=0;o<this.items.length;o++){var r=this.nextCol(e,o),a=this.items[o],c=r.height?this.gutter:0,h=r.index*s+i+"px",l=r.height+c+"px";this.useTransform?a.style.transform="translate("+h+", "+l+")":(a.style.top=l,a.style.left=h),r.height+=a.getBoundingClientRect().height+c,r.height>n&&(n=r.height)}this.container.style.height=n+"px"},i.prototype.ready=function(){return!!this.static||this.items.length>=this.size},i.prototype.getReady=function(){var t=this,e=setInterval((function(){t.container=document.querySelector(t.containerClass),t.items=t.container.children,t.ready()&&(clearInterval(e),t.init(),t.listen())}),100)},i.prototype.listen=function(){var t,e=this;this.ready()?(window.addEventListener("resize",(function(){t||(t=setTimeout((function(){e.positionItems(),t=null}),200))})),this.positionItems()):this.getReady()},i})),app_shop.txt.more="wiÄ™cej";const TextTruncate=function(t,e){this.init=()=>{const e=parseFloat(t.lineC),i=parseFloat(t.lineH);t.wrapper.querySelectorAll(".--txtToSplit").forEach((n=>{const s=n.textContent;s.length>t.count&&!n.querySelector(".ellipsis")&&n.offsetHeight>e*i&&this.addEl(n,s)}))},this.addEl=(e,i)=>{const n=i.slice(0,t.count),s=i.slice(t.count);e.innerHTML=`<span class="prev">${n}</span><span class="ellipsis">... <a href="##" class="more">${app_shop.txt.more}</a><br></span><span class="next">${s}</span>`,e.querySelector(".more").addEventListener("click",(t=>{t.preventDefault(),this.moreListener(e)}))},this.moreListener=i=>{const n=i.querySelector(".ellipsis");n&&n.remove();const s=i.querySelector(".next");s&&(s.style.display="block"),e&&e(t.wrapper,i)},this.init()},OpinionsPhotos=function(){this.vars={magicGridOptions:{container:".opinions_wrapper",static:!0,animate:!0,gutter:30,maxColumns:3,useMin:!0},observeInited:!1},this.truncate=()=>{this.textTruncate=new TextTruncate({lineH:18,lineC:2,wrapper:document.getElementById("opinions_wrapper"),count:95},this.afterTruncate)},this.afterTruncate=(t,e)=>{const i=e.closest(".opinion_item");if(!i)return;if(document.documentElement.classList.contains("touch"))return void this.magicGrid.positionItems();const n=this,s=function(){n.magicGrid.positionItems(),this.removeEventListener("mouseleave",s)};i.addEventListener("mouseleave",s)},this.imgLoaded=()=>{app_shop.vars.bLazy.options.success=()=>{this.magicGrid.positionItems()}},this.scrollEvent=()=>{this.vars.observeInited||(this.lastItemInView.observe(document.querySelector(".opinion_item:last-child")),this.vars.observeInited=!0)},this.initEvents=()=>{window.addEventListener("scroll",this.scrollEvent)},this.opinionsLoaded=()=>{this.magicGrid=new MagicGrid(this.vars.magicGridOptions),this.magicGrid.listen(),this.magicGrid.positionItems(),this.truncate(),app_shop.vars.bLazy.revalidate(),this.lastItemInView.observe(document.querySelector(".opinion_item:last-child"))},this.updateDom=t=>{const e=document.getElementById("opinions_wrapper");if(!e)return;t.querySelectorAll(".opinion_item").forEach((t=>{e.appendChild(t)})),this.opinionsLoaded();const i=document.getElementById("opinions_paging_bottom");if(!i)return;const n=t.getElementById("opinions_paging_bottom");n&&i.parentNode.replaceChild(n,i)},this.fetchNextPage=async()=>{const t=document.querySelector("#opinions_paging_bottom a.next");if(!t)return;const e=t.getAttribute("href");try{const t=await fetch(e),i=await t.text(),n=(new DOMParser).parseFromString(i,"text/html");this.updateDom(n),app_shop.fn.change_url(e)}catch(t){window.location=e}},this.lastItemInView=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(this.fetchNextPage(),this.lastItemInView.unobserve(t.target))}))})),this.init=()=>{this.truncate(),this.imgLoaded(),this.magicGrid=new MagicGrid(this.vars.magicGridOptions),this.magicGrid.listen(),this.initEvents()}};app_shop.fn.opinionsPhotos=new OpinionsPhotos,app_shop.run((function(){app_shop.fn.opinionsPhotos.init()}),"all",".opinion_item");
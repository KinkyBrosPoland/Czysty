const SliderTXT={"To jest pierwszy slajd":"To jest pierwszy slajd","To jest ostatni slajd":"To jest ostatni slajd","Poprzedni slajd":"Poprzedni slajd","Następny slajd":"Następny slajd","Idź do slajdu":"Idź do slajdu"};class Slider{constructor({beforeInit:e,afterInit:t,beforeSetup:s,afterSetup:i}={}){this.swiperModule={},this.localPrefix=this.constructor.name,this.txt={...SliderTXT},this.slider=null,this.sliderEventListeners=[],this.settings={defaultModule:"SwiperCore",enableA11y:!0,disableAutoHeightListener:!1,useDefaultModules:!0,autoHeightUpdateSpeed:350},this.callbacks={beforeInit:e??(async()=>({result:!0,extendOptions:!0,options:{}})),afterInit:t??(async()=>Promise.resolve()),beforeSetup:s??(async()=>({result:!0,extendOptions:!0,options:{}})),afterSetup:i??(async()=>Promise.resolve())},this.options={init:!1,preloadImages:!1,lazy:!0,loop:!0,autoHeight:!0,slidesPerView:4,grabCursor:!0,uniqueNavElements:!0},this.accessibilityOptions={enabled:!0,firstSlideMessage:this.txt["To jest pierwszy slajd"],lastSlideMessage:this.txt["To jest ostatni slajd"],prevSlideMessage:this.txt["Poprzedni slajd"],nextSlideMessage:this.txt["Następny slajd"],paginationBulletMessage:`${this.txt["Idź do slajdu"]} {{index}}`,slideLabelMessage:"{{index}} / {{slidesLength}}",notificationClass:"swiper-notification"}}async init({extend:e=!0,options:t={},settings:s={}}={}){const i=await this.fetchModule();if(!i)return app_shop.vars.utils.debug(this.localPrefix,"(async) init","nie można pobrać modułu Swipera",i),!1;const{result:a=!0,extendOptions:o=!0,options:n={}}=await this.callbacks.beforeInit(t,s);if(!a)return app_shop.vars.utils.debug(this.localPrefix,"(async) init",'anulowano inicjalizację slidera - według opcji "result" z callbacku "beforeInit"',a),!1;this.setSettings(s),this.settings.useDefaultModules&&this.setDefaultModules();const l=void 0!==o?o:e;this.setOptions({extend:l,options:{...t,...n}});return this.settings.enableA11y&&await this.fetchModule("SwiperUtils")&&this.enableA11y(),await this.callbacks.afterInit(this.options),!0}async fetchModule(e=this.settings.defaultModule){if(!e)return app_shop.vars.utils.debug(this.localPrefix,"(async) fetchModule","Wskazana nazwa modułu musi być typem string: ",e),!1;const t=await appModules.load(e);return app_shop.vars.utils.debug(this.localPrefix,"(async) fetchModule","Rozpoczęto pobieranie modułu Swipera: ",t),t?(this.swiperModule[e]=t,!0):(app_shop.vars.utils.debug(this.localPrefix,"(async) fetchModule","Wykryto błąd pobierania modułu Swipera. Sprawdź logi konsoli."),!1)}getSlider(){return this.slider}watchEvent(e,t){return this.sliderEventListeners.push({eventName:e,fn:t}),app_shop.vars.utils.debug(this.localPrefix,"watchEvent",`Listener dla eventu (${e}) został dodany: `,t),this}setThumbnails(e){const t=e?.getSlider();if(!t)return app_shop.vars.utils.debug(this.localPrefix,"setThumbnails","slider z miniaturkami nie istnieje",e,t),this;const s={options:{thumbs:{swiper:t}}};return this.setOptions(s),app_shop.vars.utils.debug(this.localPrefix,"setThumbnails","Slider miniaturek został podłączony: ",s),this}setSlide(e,t=0,s=!0){return"number"!=typeof e||Number.isNaN(e)?(app_shop.vars.utils.debug(this.localPrefix,"setSlide",'przekazany parametr "slideIndex" musi być type number i nie może być NaN\'em'),this):(this.slider.slideTo(e,t,s),this)}watchElementLoad({element:e=null,eventType:t="load",onLoad:s}={}){if(!e||"function"!=typeof s)return app_shop.vars.utils.debug(this.localPrefix,"watchElementLoad","element musi być typu HTMLElement",e," - onLoad musi być funkcją",s),this;const i=new AbortController,a=()=>i.abort();return e.addEventListener(t,(e=>s(e,a)),{signal:i.signal}),this}setAutoHeightListeners(e){const t=e?.querySelectorAll(".swiper-slide.slide-lazy");app_shop.vars.utils.debug(this.localPrefix,"setAutoHeightListeners","Lista slajdów z lazy loadingiem: ",t);const s=e=>(e.classList.remove("slide-lazy"),this.slider.initialized&&this.slider.updateAutoHeight(this.settings.autoHeightUpdateSpeed),!0),i=e=>e.readyState>=3||!0===e.complete;return t?.forEach((e=>{const t=e.querySelector("img[loading], video");if(!t)return;const a=t instanceof HTMLVideoElement?"loadeddata":"load";if(i(t))return s(e);this.watchElementLoad({eventType:a,element:t,onLoad:(t,a)=>{a(),i(t.target)&&s(e)}})})),this}attachListeners(e){return this.options.autoHeight&&!1===this.settings.disableAutoHeightListener&&this.setAutoHeightListeners(e),this.sliderEventListeners.forEach((({eventName:t,fn:s})=>{t&&"function"==typeof s?this.slider.on(t,(function(){s(this,e)})):app_shop.vars.utils.debug(this.localPrefix,"attachListeners",`eventName (${t}) musi być stringiem, drugi przekazany parametr musi być funkcją (${s})`)})),this}extendModules(e){const t=Array.isArray(this.options.modules)?this.options.modules:[];app_shop.vars.utils.debug(this.localPrefix,"extendModules","Aktywne moduły slidera: ",t);const s=[...t,...e].filter((e=>e));return app_shop.vars.utils.debug(this.localPrefix,"extendModules","Nowe moduły: ",e),this.options.modules=s,app_shop.vars.utils.debug(this.localPrefix,"extendModules","Złączone moduły: ",s),this}setDefaultModules(){const{Pagination:e,Navigation:t,Thumbs:s}=this.swiperModule[this.settings.defaultModule],i={options:{modules:[e,t,s]}};return this.setOptions(i),app_shop.vars.utils.debug(this.localPrefix,"setDefaultModules","Ustawiono domyślne moduły: ",i),this}loadSelectedModules(){const e=this.swiperModule[this.settings.defaultModule];return(this.options?.freeMode||this.options?.freeMode?.enabled)&&"function"==typeof e?.FreeMode&&(this.extendModules([e.FreeMode]),app_shop.vars.utils.debug(this.localPrefix,"loadSelectedModules","Załadowano moduł FreeMode")),"fade"===this.options?.effect&&"function"==typeof e?.EffectFade&&(this.extendModules([e.EffectFade]),app_shop.vars.utils.debug(this.localPrefix,"loadSelectedModules","Załadowano moduł EffectFade")),"autoplay"in this.options&&"function"==typeof e?.Autoplay&&(this.extendModules([e.Autoplay]),app_shop.vars.utils.debug(this.localPrefix,"loadSelectedModules","Załadowano moduł Autoplay")),this}enablePagination({element:e,...t}={}){const s="string"==typeof e?document.querySelector(e):e;if(!s)return app_shop.vars.utils.debug(this.localPrefix,"enablePagination","Wskazany element nie istnieje"),this;const i=s.querySelector(".swiper-pagination");if(!i)return app_shop.vars.utils.debug(this.localPrefix,"enablePagination","Element paginacji nie istnieje"),this;const a={options:{pagination:{el:i,...t}}};return this.setOptions(a),app_shop.vars.utils.debug(this.localPrefix,"enablePagination","Ustawiono paginację: ",a),this}enableNavigation({element:e,nextEl:t=null,prevEl:s=null,...i}={}){const a="string"==typeof e?document.querySelector(e):e;if(!a)return app_shop.vars.utils.debug(this.localPrefix,"enablePagination","Wskazany element nie istnieje"),this;const[o,n]=[t??a.querySelector(".swiper-button-next"),s??a.querySelector(".swiper-button-prev")];if(!o||!n)return app_shop.vars.utils.debug(this.localPrefix,"enableNavigation","Element nawigacji nie istnieje"),this;const l={options:{navigation:{nextEl:o,prevEl:n,...i}}};return this.setOptions(l),app_shop.vars.utils.debug(this.localPrefix,"enableNavigation","Ustawiono nawigację: ",l),this}async enableFadeEffect({...e}={}){const t={options:{effect:"fade",fadeEffect:{crossFade:!0,...e}}};return this.setOptions(t),app_shop.vars.utils.debug(this.localPrefix,"enableFadeEffect","Włączono moduł EffectFade: ",t),this}async enableFreeMode({...e}={}){const t={options:{freeMode:{enabled:!0,sticky:!0,...e}}};return this.setOptions(t),app_shop.vars.utils.debug(this.localPrefix,"enableFreeMode","Włączono moduł FreeMode: ",t),this}enableAutoPlay({speed:e=5e3,...t}={}){const s={options:{autoplay:{delay:e||5e3,disableOnInteraction:!1,...t}}};return this.setOptions(s),app_shop.vars.utils.debug(this.localPrefix,"enableAutoPlay","Włączono moduł Autoplay: ",s),this}enableA11y({...e}={}){const t="SwiperUtils",s=this.swiperModule[t];if("function"!=typeof s?.A11y)return app_shop.vars.utils.debug(this.localPrefix,"enableA11y","Wskazany moduł nie jest funkcją: ",t,s),Promise.reject(!1);this.extendModules([s.A11y]);const i={options:{a11y:{...this.accessibilityOptions,...e}}};return this.setOptions(i),app_shop.vars.utils.debug(this.localPrefix,"enableA11y","Włączono moduł A11y: ",i),this}setOptions({extend:e=!0,options:t={}}={}){return this.options={...e?this.options:{},...t},app_shop.vars.utils.debug(this.localPrefix,"setOptions",`Zmieniono opcje slidera (extend = ${e}): `,t," Nowe opcje: ",this.options),this}setSettings(e={}){return this.settings={...this.settings,...e},app_shop.vars.utils.debug(this.localPrefix,"setSettings","Zmieniono ustawienia slidera: ",e," Nowe ustawienia: ",this.settings),this}async setupSlider({element:e,customName:t=""}={}){if(!e)return app_shop.vars.utils.debug(this.localPrefix,"(async) setupSlider",'Parametr "element" musi być typu "HTMLElement" lub "string"'),!1;void 0===this.options.navigation&&this.enableNavigation({element:e}),void 0===this.options.pagination&&this.enablePagination({element:e});const{result:s=!0,extendOptions:i=!0,options:a={}}=await this.callbacks.beforeSetup(this.options,this.settings);if(!s)return app_shop.vars.utils.debug(this.localPrefix,"(async) init",'anulowano inicjalizację slidera - według opcji "result" z callbacku "beforeInit"',s),!1;const{Swiper:o}=this.swiperModule[this.settings.defaultModule];return this.loadSelectedModules(),this.setOptions({...void 0!==i?{extend:!!i}:{},options:a}),this.slider=new o(e,this.options),this.attachListeners(e),this.slider.init(),app_shop.vars.sliderConfig?.sliderList?.push({element:e,sliderClass:this,name:this.constructor.name,customName:t}),await this.callbacks.afterSetup(this.slider),this}destroy(e=!0,t=!0){return void 0!==app_shop.vars.sliderConfig?.sliderList&&Array.isArray(app_shop.vars.sliderConfig?.sliderList)&&(app_shop.vars.sliderConfig.sliderList=app_shop.vars.sliderConfig.sliderList.filter((s=>s.sliderClass!=this||(this.slider.destroy(e,t),!1)))),this}}class SliderThumbnails extends Slider{constructor({beforeInit:e,afterInit:t,beforeSetup:s,afterSetup:i}={}){super({beforeInit:e,afterInit:t,beforeSetup:s,afterSetup:i})}async init({options:e={}}={}){if(!await super.init({options:e}))return!1;const{Thumbs:t,Navigation:s}=this.swiperModule[this.settings.defaultModule];return this.setOptions({extend:!1,options:{modules:[t,s],direction:e?.direction||"vertical",watchSlidesProgress:!0,grabCursor:!0,spaceBetween:"15px",slidesPerView:e?.slidesPerView||5,...e}}),e?.freeMode&&this.enableFreeMode(),!0}}function getGalleryConfiguration(e){const t="true"===e.getAttribute("data-thumbnails-horizontal")?"horizontal":"vertical",s=e.getAttribute("data-thumbnails-count"),i=(()=>{const e=parseFloat(s);return"string"!=typeof s?5:"auto"===s?"auto":Number.isNaN(e)?5:e})(),a="true"===e.getAttribute("data-thumbnails-slider"),o="true"===e.getAttribute("data-slider-autoplay-enable"),n=parseFloat(e.getAttribute("data-slider-autoplay-speed")),l=Number.isNaN(n)?null:n;return{enableFadeEffect:"true"===e.getAttribute("data-slider-fade-effect"),thumbnailsDirection:t,centeredSlides:"true"===e.getAttribute("data-slider-centered"),thumbnailsCount:i,sliderEnabled:"true"===e.getAttribute("data-slider-enable"),thumbnailsEnabled:"true"===e.getAttribute("data-thumbnails-enable"),thumbnailsSliderEnabled:a,enableFreeMode:"true"===e.getAttribute("data-slider-freemode"),sliderAutoplaySpeed:l,autoplayEnable:o,htmlEnabled:"true"===e.getAttribute("data-html-enable")}}export{Slider,SliderThumbnails,getGalleryConfiguration};
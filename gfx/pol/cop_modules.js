app_shop.vars.isOtherAddressChange=!1,app_shop.vars.isBillingOtherAddressChange=!1;class FetchError extends Error{constructor(e={}){super(e.message||"GraphQL fetchData() Error"),this.txt={...ERROR_TXT},this.alert=e.alert,this.alertTime=e.alertTime||1e4,this.txtCodes=this.getTxtCodes(),this.timeCodes=this.getTimeCodes(),this.response=e.response,this.message=this.getMessage(this.response),Error.captureStackTrace&&Error.captureStackTrace(this,FetchError)}getTxtCodes(){const e={110:`${this.txt["Produkt, który kupujesz nie jest już dostępny"]}. <a class="alertek__link --not-enough" href="/basketedit.php">${this.txt["Przejdź do koszyka"]}</a>, ${this.txt["aby dowiedzieć się więcej"]}.`,115:`${this.txt["Twój koszyk jest pusty. Wróć do sklepu i"]} <a class="alertek__link --basket-empty" href="/">${this.txt["rozpocznij zakupy"]}</a>.`,100:`${this.txt["Sklep jest dostępny tylko dla klientów hurtowych. Jeżeli chciałbyś uzyskać status hurtownika skontaktuj się z obsługą sklepu"]}.`,109:`${this.txt["Nie osiągnięto minimalnej wartości zamówienia hurtowego"]}. <a class="alertek__link --minimal-wholesale" href="/basketedit.php">${this.txt["Przejdź do koszyka"]}</a>, ${this.txt["aby dowiedzieć się więcej"]}.`,123:`${this.txt["Łączna suma złożonych przez Ciebie zamówień jest zbyt duża"]}.<br/>${this.txt["Poczekaj aż zrealizujemy to co zamówiłeś wcześniej, lub"]} <a class="alertek__link --order-too-much" href="/login.php">${this.txt["anuluj wcześniejsze zamówienie"]}</a>.`,32:`${this.txt["Nie uzupełniłeś numer domu / lokalu"]}`};return{...e,OrderFailBasketIsEmpty:e[115],order_notenough:e[110]}}getTimeCodes(){return{100:5e3}}getMessage(e){if(e){const{errors:[t={}]=[]}=e;let{code:s,message:a}=t;s=s||t?.extensions?.code,this.alertTime=this.timeCodes[s]||this.alertTime;return this.txtCodes[s]||this.txtCodes[a]||a||this.txt["Wystąpił błąd połączenia. Sprawdź łącze internetowe lub spróbuj ponownie później"]}return this.txt["Wystąpił błąd połączenia. Sprawdź łącze internetowe lub spróbuj ponownie później"]}logError(){this.reportError(this.response?.errors?.[0]),this.alert&&Alertek.Error(this.message,this.alertTime)}reportError(e){window?.errorLog?.(e)}}try{app_shop.fn.copModulesformValidationInstance=new FormValidation({formSelector:"form.cop"})}catch(e){window?.errorLog?.(e)}class COPModules{constructor(e={}){this.prefix=e.prefix||"cop",this.logged=e.logged||app_shop.vars.logged||!1,this.validate=app_shop.fn.copModulesformValidationInstance,this.minDelayTime=700,this.queries={...COPModulesGQL},this.txt={...COPModulesTXT},this.language=e.language||app_shop?.vars?.language?.symbol||"pl",this.locale={shortWeekdays:[],weekdays:[this.txt.Dzisiaj,this.txt["Poniedziałek"],this.txt.Wtorek,this.txt["Środa"],this.txt.Czwartek,this.txt["Piątek"],this.txt.Sobota,this.txt.Niedziela],onWeekdays:[this.txt.dzisiaj,this.txt["w poniedziałek"],this.txt["we wtorek"],this.txt["w środę"],this.txt["w czwartek"],this.txt["w piątek"],this.txt["w sobotę"],this.txt["w niedzielę"]]},this.getLocale()}decodeGraphQLHTMLString(e){try{if(!e)return"";return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}catch(e){return""}}status(e){const{element:t,status:s,remove:a=!0,afterRemove:i=()=>{}}=e;if(t)switch(s){case"loading":t.classList.add("--loading");break;case"success":if(t.classList.remove("--loading"),t.classList.add("--success"),!a)break;setTimeout((function(){t.classList.remove("--success"),i()}),1e3);break;case"error":if(t.classList.remove("--loading"),t.classList.add("--error"),!a)break;setTimeout((function(){t.classList.remove("--error"),i()}),1e3);break;default:t.classList.remove("--loading","--success","--errror")}}addFocusEvents(e){if(!e)return;e.querySelectorAll(".f-group .f-control").forEach((e=>{e.addEventListener("change",this.addFocus),e.addEventListener("input",this.addFocus),e.addEventListener("focus",this.addFocus),e.addEventListener("blur",this.addFocus)}))}addFocus(e){const t=e.target?.closest(".f-group")||e;if(!t)return;t.querySelectorAll("input").forEach((e=>{e.nextElementSibling?.classList.contains("f-label")&&(""===e.value?e.classList.remove("focused"):e.classList.add("focused"))}))}getFormDataFromSessionStorage(){const e=sessionStorage.getItem("COPModulesFormData"),t=window.COPModulesFormData;return e||t?{...JSON.parse(e),...t}:{}}saveFormDataToSessionStorage(){const e=document.querySelector(this.vars.formSelector);if(!this.vars.formSelector||!e)return;const t=new FormData(e),s=JSON.stringify(Object.fromEntries(t));sessionStorage.setItem("COPModulesFormData",s)}getLocale(){for(let e=0;e<7;e++){let t=new Date(0,0,e).toLocaleString(this.language,{weekday:"short"});t=`${t.charAt(0).toUpperCase()}${t.substring(1,t.length)}`,this.locale.shortWeekdays.push(t)}}createInfo(e){const t=document.createElement("div");t.classList.add("menu_messages_message");const s=document.createElement("p");return s.textContent=e,t.appendChild(s),t}calculateDate(e){const{days:t=0,hours:s=0,minutes:a=0}=e,i=new Date(Date.now()+24*t*60*60*1e3+60*s*60*1e3+60*a*1e3);return{day:i.getDate()<10?`0${i.getDate()}`:i.getDate(),month:i.getMonth()+1<10?`0${i.getMonth()+1}`:i.getMonth()+1,year:i.getFullYear()}}getFormattedDate(e){const t=new Date(e.replace(/-/g,"/")),s=new Date,a=Math.floor((t-s)/864e5)+1,i=Math.floor(a/7),o=this.locale.weekdays[0===t.getDay()?7:t.getDay()];if(0===a)return this.locale.weekdays[0];if(0===i)return o;return`${o} (${e.split("-")[2]}.${e.split("-")[1]})`}changeLiteral(e,t={}){const{numerals:s=[],withValue:a=!0}=t,[i="",o="",r=""]=s;if(1===e)return a?`${e} ${o}`:`${o}`;const n=e%10,c=e%100;return 0===e||n>=0&&n<=1||n>=5&&n<=9||c>10&&c<20?a?`${e} ${i}`:`${i}`:(c<10||c>20)&&n>=2&&n<=4?a?`${e} ${r}`:`${r}`:a?`${e}`:""}debounce(e,t=500){let s;return(...a)=>{clearTimeout(s),s=setTimeout((()=>e(...a)),t)}}elementInViewport(e,t){if(!e)return!1;const s=e.getBoundingClientRect();let a;a=t?t.getBoundingClientRect():{top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};const{top:i,left:o,right:r,bottom:n}=s,{top:c,left:h,right:l,bottom:p}=a;return i>=c&&o>=h&&r<=l&&n<=p}scrollToElement(e={}){const{element:t,additionalYOffset:s=(app_shop.vars.view<3?50:0),callback:a,forceScroll:i=!1}=e;if(!t)return;if(this.elementInViewport(t)&&!i)return void a?.();const o=t.getBoundingClientRect(),r=document.querySelector(".--fixed-header header"),n=r?r.offsetHeight:0,{top:c}=o,h=c+window.pageYOffset-60-n-(s||0),l=h.toFixed(),p=()=>{window.pageYOffset.toFixed()===l&&(window.removeEventListener("scroll",p),a?.())};window.addEventListener("scroll",p),p(),window.scrollTo({top:h,behavior:"smooth"})}move(e={}){const{element:t,moveSelector:s,moveType:a}=e;if(!t)return;let{moveElement:i}=e;if((i||s)&&(s&&(i=document.querySelector(s)),i))switch(a){case"append":default:i.append(t);break;case"prepend":i.prepend(t);break;case"after":i.after(t);break;case"before":i.before(t);break;case"replace":i.replaceWith(t)}}showModalWarning(){const e=document.getElementById(`${this.prefix}_menu_notice`);e&&(this.modalWarning=new Modal({element:e,classList:"--extrasmall",setFocusOnFirstElement:!0}))}onBeforeunloadEvent(e){return e.preventDefault(),e.returnValue=`${COPModulesTXT["Twoje zmiany nie zostały zapisane. Czy na pewno chcesz opuścić tę stronę"]}?`,`${COPModulesTXT["Twoje zmiany nie zostały zapisane. Czy na pewno chcesz opuścić tę stronę"]}?`}initBeforeClosePage(){if("order2"!==this.type&&"oscop"!==this.type)return;let e=!1;window.addEventListener("beforeunload",this.onBeforeunloadEvent),document.addEventListener("click",(t=>{const{target:s}=t;if(!s.closest(`a:not([target="_blank"]):not([href^="mailto:"]):not([href^="tel:"]):not(.bars__close):not(.${this.prefix}_street_number__close):not(.${this.prefix}_street_number__focus):not(.${this.prefix}_client_exists__action):not(.alertek__link):not(#backTop):not(.${this.prefix}_pickup_marker__choose_link):not(.${this.prefix}_verification__edit)`)||s.closest(`.${this.prefix}`)||s.closest(".modal")||(t.preventDefault(),this.showModalWarning(),e=s),s.closest(`.${this.prefix}_login__service`)||s.closest(`.${this.prefix}_signin__recover`)||s.closest(`.${this.prefix}_client_exists__action`)||s.closest(".alertek__link")||s.closest(`.${this.prefix}_verification__edit`)||s.closest(`.${this.prefix}_buttons`)||s.closest('a[target="_blank"]')||s.closest('a[href^="mailto:"]')||s.closest('a[href^="tel:"]')?window.removeEventListener("beforeunload",this.onBeforeunloadEvent):window.addEventListener("beforeunload",this.onBeforeunloadEvent),s.closest(".menu_notice__button")){if(t.preventDefault(),s.classList.contains("--continue"))return this.modalWarning?.closeModal(),!1;window.removeEventListener("beforeunload",this.onBeforeunloadEvent),e.closest("a")&&(window.location=e.closest("a").getAttribute("href"))}return!0}))}async fetchData(e={}){const{data:t,link:s,linkParameter:a="",alert:i=!0,cacheName:o=!1,onlyFromCache:r=!1}=e;if(o&&sessionStorage.getItem(o)||r)return JSON.parse(sessionStorage.getItem(o));if(!t)return!1;try{const e=await fetch(`${s||app_shop.urls.graphql||"/graphql/v1/"}${a}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:t}),r=await e.json();if(r?.errors||r?.error)throw new FetchError({alert:i,response:r});return o&&sessionStorage.setItem(o,JSON.stringify(r)),r}catch(e){return e instanceof FetchError?(e.logError(),e.response):(i&&Alertek.Error(this.txt["Wystąpił błąd połączenia. Sprawdź łącze internetowe lub spróbuj ponownie później"]),!1)}}setData(e,t){sessionStorage.setItem(e,JSON.stringify(t))}clearCache(e){if(e?.length)e.forEach((e=>{sessionStorage.removeItem(e)}));else{app_shop.vars.isLogged=!1;for(let e=0;e<sessionStorage.length;){const t=sessionStorage.key(e);t.startsWith(this.prefix)?sessionStorage.removeItem(t):e+=1}}}getCleanedQuery(e){return e.replace(/\\n|^{"query":"query {| \}"}$/g," ").replace(/\\"/g,'"').replace(/\s+/g," ").trim()}async getData(e={}){const{name:t,state:s,onlyFromCache:a=!1,onlyQuery:i=!1}=e;switch(t){case"payments":{const e=document.querySelector('input[name="client_type"]:checked')?.value||"private";if(i)return this.getCleanedQuery(this.queries.PAYMENTS(`clientType: ${e}`));const t=await this.fetchData({data:this.queries.PAYMENTS(`clientType: ${e}`),linkParameter:`?query=copModulesPayments&type=${this.type}`,onlyFromCache:a});return t?.data}case"shipping":{const e=`ShippingInput: {\n        mode: basket,\n        ${s?.coordinates?`coordinates: { latitude: ${s.coordinates.lat}, longitude: ${s.coordinates.lng}}`:""}\n      }`;if(i)return this.getCleanedQuery(this.queries.SHIPPING(e));const t=await this.fetchData({data:this.queries.SHIPPING(e),linkParameter:`?query=copModulesShipping&type=${this.type}`,onlyFromCache:a});return t?.data}case"settings":{if(i)return this.getCleanedQuery(this.queries.SETTINGS());const e=await this.fetchData({data:this.queries.SETTINGS(),linkParameter:`?query=copModulesSettings&type=${this.type}`,onlyFromCache:a});return e?.data?.shop}case"basket":{if(i)return this.getCleanedQuery(this.queries.BASKET());const e=await this.fetchData({data:this.queries.BASKET(),linkParameter:`?query=copModulesBasket&type=${this.type}`,onlyFromCache:a});return e?.data}case"order":{const e=await this.getData({name:"payments",onlyFromCache:!0}),t=await this.getData({name:"shipping",state:s,onlyFromCache:!0}),a=await this.getData({name:"settings",onlyFromCache:!0}),i=await this.getData({name:"basket",onlyFromCache:!0});if(e&&t&&a&&i){return{...e,...t,...a,...i}}const o=e?"":await this.getData({name:"payments",onlyQuery:!0}),r=t?"":await this.getData({name:"shipping",state:s,onlyQuery:!0}),n=a?"":await this.getData({name:"settings",onlyQuery:!0}),c=i?"":await this.getData({name:"basket",onlyQuery:!0}),h=JSON.stringify({query:`query {\n          ${o}\n          ${r}\n          ${n}\n          ${c}\n        }`}),{data:l}=await this.fetchData({data:h,linkParameter:`?query=copModulesInit&type=${this.type}`})||{},{paymentsMethod:p,shipping:d,shop:u,basket:g}=l||{},m={...e,...t,...a,...i};return""!==o&&p&&(m.paymentsMethod=p),""!==r&&d&&(m.shipping=d),""!==n&&u&&(m.settings=u.settings),""!==c&&g&&(m.basket=g),m}case"division":{const e=await this.getData({name:"shipping",state:s,onlyFromCache:!0}),t=await this.getData({name:"basket",onlyFromCache:!0});if(e&&t){return{...e,...t}}const a=e?"":await this.getData({name:"shipping",state:s,onlyQuery:!0}),i=t?"":await this.getData({name:"basket",onlyQuery:!0}),o=JSON.stringify({query:`query {\n          ${a}\n          ${i}\n        }`}),{data:r}=await this.fetchData({data:o,linkParameter:`?query=copModulesAfterDivision&type=${this.type}`})||{},{shipping:n,basket:c}=r||{},h={...e,...t};return""!==a&&n&&(h.shipping=n),""!==i&&c&&(h.basket=c),h}case"region":{const e=await this.getData({name:"payments",onlyFromCache:!0}),t=await this.getData({name:"shipping",state:s,onlyFromCache:!0});if(e&&t){return{...e,...t}}const a=e?"":await this.getData({name:"payments",onlyQuery:!0}),i=t?"":await this.getData({name:"shipping",state:s,onlyQuery:!0}),o=JSON.stringify({query:`query {\n          ${a}\n          ${i}\n        }`}),{data:r}=await this.fetchData({data:o,linkParameter:`?query=copModulesAfterChangeRegion&type=${this.type}`})||{},{paymentsMethod:n,shipping:c}=r||{},h={...e,...t};return""!==a&&n&&(h.paymentsMethod=n),""!==i&&c&&(h.shipping=c),h}default:return!1}}async updateData(e={}){const{type:t}=e;switch(t){case"division":{const e=await this.getData({name:"division"}),{shipping:t,basket:s}=e||{};this.vars.shipping=t,this.vars.basket=s;break}case"region":{const e=await this.getData({name:"region"}),{shipping:t,paymentsMethod:s}=e||{};this.vars.shipping=t,this.vars.paymentsMethod=s;break}}}async getInitData(){switch(this.type){case"oscop":case"order1":case"order2":{const e=await this.getData({name:"order"}),{basket:t,paymentsMethod:s,shipping:a,settings:i}=e||{},o=[];this.vars={basket:t,paymentsMethod:s,shipping:a,settings:i,holidays:o};break}}}getCookieByName(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length&&t.pop().split(";").shift()}resetRegionForced(){document.cookie="setRegionForced=; path=/; Max-Age=-99999999;"}async checkRegionAndZipcodeForced(){if(this.getCookieByName("setRegionForced")||this.getCookieByName("setZipcodeForced")){if(this.getCookieByName("setRegionForced")&&this.getCookieByName("setZipcodeForced"))return document.cookie="setRegionForced=; path=/; Max-Age=-99999999;",document.cookie="setZipcodeForced=; path=/; Max-Age=-99999999;",void await this.fetchData({data:this.queries.UNSET_REGION_AND_ZIPCODE(),linkParameter:`?mutation=copModulesUnsetRegionAndZipcode&type=${this.type}`});if(this.getCookieByName("setRegionForced"))return document.cookie="setRegionForced=; path=/; Max-Age=-99999999;",void await this.fetchData({data:this.queries.UNSET_REGION(),linkParameter:`?mutation=copModulesUnsetRegion&type=${this.type}`});document.cookie="setZipcodeForced=; path=/; Max-Age=-99999999;",await this.fetchData({data:this.queries.UNSET_ZIPCODE(),linkParameter:`?mutation=copModulesUnsetZipcode&type=${this.type}`})}}async init(e={}){this.type=e.type||app_shop.vars.copModulesType||"order1","oscop"===this.type&&await this.checkRegionAndZipcodeForced(),await this.getInitData(),this.initBeforeClosePage()}afterAllModulesInit(){}}try{app_shop.fn.copModules=new COPModules,app_shop.vars.copModulesClasses.push((()=>{app_shop.fn.copModules=new COPModules}))}catch(e){window?.errorLog?.(e)}
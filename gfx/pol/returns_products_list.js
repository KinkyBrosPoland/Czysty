const returnsTxt={maxQuantity:"Maksymalnie możesz zwrócić ",choose:"Wybierz produkty do zwrotu",select:"Zaznacz wszystkie produkty ",unselect:"Odznacz wszystkie produkty "},ReturnsProductList=function(){return this.getValues=t=>({amount:parseFloat(t.querySelector("input[name=data_amount]").value,10),sellBy:parseFloat(t.querySelector("input[name=data_unit_sellby]").value,10),precision:parseFloat(t.querySelector("input[name=data_unit_precision]").value,10),quantity:parseFloat(t.querySelector("input[type=text]").value,10),unit:t.querySelector("input[name=data_unit]").value}),this.numberCheck=t=>{const e=t.querySelector("input[type=text]");if(!e)return;const n=t.closest(".productslist_item");if(!n)return;const s=n.querySelector(".productslist_product_action input");if(!s)return;const{amount:i,quantity:c,unit:o}=this.getValues(t);if(c<=0)return e.value=0,void(s.checked=!1);s.checked=!0,i<c&&(e.value=i,Alertek.show_alert(`${returnsTxt.maxQuantity} ${i} ${o}`))},this.onClickAddQuantity=t=>{const e=t.closest(".productslist_product_quantity");if(!e)return;const n=e.querySelector("input[type=text]");if(!n)return;const{sellBy:s,precision:i,quantity:c}=this.getValues(e);n.value=(c+s).toFixed(i),this.numberCheck(e)},this.onClickDelQuantity=t=>{const e=t.closest(".productslist_product_quantity");if(!e)return;const n=e.querySelector("input[type=text]");if(!n)return;const{sellBy:s,precision:i,quantity:c}=this.getValues(e);n.value=(c-s).toFixed(i),this.numberCheck(e)},this.onClickSelectAll=t=>{const e=document.querySelectorAll(".productslist_product_action:not([style]) input");if(t.classList.contains("--checked"))return t.classList.remove("--checked","icon-minus"),t.classList.add("icon-plus"),t.textContent=returnsTxt.select,void e.forEach((t=>{t.checked=!1,this.onChangeInputAction(t)}));t.classList.add("--checked","icon-minus"),t.classList.remove("icon-plus"),t.textContent=returnsTxt.unselect,e.forEach((t=>{t.checked=!0,this.onChangeInputAction(t)}))},this.onChangeInputQuantity=t=>{const e=t.closest(".productslist_product_quantity");e&&this.numberCheck(e)},this.onChangeInputAction=t=>{const e=t.closest(".productslist_item");if(!e)return;const n=e.querySelector(".productslist_product_quantity");if(!n)return;const s=n.querySelector("input[type=text]");if(!s)return;const{sellBy:i}=this.getValues(n);s.value=t.checked?i:0},this.onChangeInputComment=t=>{const e=document.querySelector("textarea.return_comment");e&&(e.style.display=t.checked?"":"none")},this.validateForm=()=>null!==document.querySelector(".productslist_product_action input:checked"),this.initEvents=()=>{const t=document.querySelector(".returns_productslist");t&&(t.addEventListener("click",(t=>{const{target:e}=t;e.closest(".addQuantity")&&(t.preventDefault(),this.onClickAddQuantity(e.closest(".addQuantity"))),e.closest(".delQuantity")&&(t.preventDefault(),this.onClickDelQuantity(e.closest(".delQuantity"))),e.closest(".productslist_tools_bottom .select_all")&&(t.preventDefault(),this.onClickSelectAll(e.closest(".productslist_tools_bottom .select_all")))})),t.addEventListener("change",(t=>{const{target:e}=t;e.closest(".productslist_product_quantity input[type=text]")&&this.onChangeInputQuantity(e),e.closest(".productslist_product_action input")&&this.onChangeInputAction(e),e.closest(".return_product_checkbox")&&this.onChangeInputComment(e)})),t.addEventListener("submit",(e=>{if(e.preventDefault(),!this.validateForm())return void Alertek.show_alert(returnsTxt.choose);const n=window.location.pathname+window.location.search;localStorage.setItem("linkToProductsCurrentReturns",n),t.submit()})))},this.init=()=>{this.initEvents()},this.init()};app_shop.run((()=>{app_shop.fn.returnsProductList=new ReturnsProductList}),"all",".returns_productslist.--returns");
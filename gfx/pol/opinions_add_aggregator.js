app_shop.vars.opinion_send="Twoja opinia o zamówieniu została wysłana, dziękujemy. Jeżeli chcesz ją zmienić kliknij <a href='#edit' class='opinion_edit'>tutaj</a>.",app_shop.vars.opinion_send2="Twoja opinia o produkcie została wysłana, dziękujemy.",app_shop.vars.opinion_error="Twoja opinia nie została wysłana.",app_shop.vars.opinion_empty="Podaj treść opinii.",app_shop.vars.opinion_file_size="Max. rozmiar zdjęcia to: 2048x1536px.",app_shop.vars.opinion_file_type="Dopuszczalne formaty zdjęć: jpg.",app_shop.fn.encodeImagetoBase64=function(e,o){const n=e.files[0],i=new FileReader;i.onload=function(){o&&o(i.result)},i.readAsDataURL(n)},app_shop.fn.opinionSendInfo=function(e){if(!e)return;function o(e,o){e.insertAdjacentHTML("beforeend",o)}const n=e.querySelector(".opinion_products__block.--opinion");if(app_shop.vars.view<3&&n)return o(n,`<div class="opinion_send menu_messages_message">${app_shop.vars.opinion_send2}</div>`),void e.classList.add("--ready");if(e.closest("#opinion_order"))return o(e,`<div class="opinion_send menu_messages_message">${app_shop.vars.opinion_send}</div>`),void e.classList.add("--ready");o(e,`<div class="opinion_send menu_messages_message">${app_shop.vars.opinion_send2}</div>`),e.classList.add("--ready")},app_shop.vars.blockAjaxOpinion=!1,app_shop.fn.sendOpinionsAjax=function(e,o){if(app_shop.vars.blockAjaxOpinion)return;const n="string"==typeof e?document.querySelector(e):e;n&&(n.classList.add("load-content"),app_shop.vars.blockAjaxOpinion=!0,fetch(n.getAttribute("action"),{method:n.getAttribute("method"),body:o,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>e.json())).then((e=>{e.result.id||0===e.result.id?app_shop.fn.opinionSendInfo(n):e.errors.faultCode&&Alertek.Start(e.errors.faultString),app_shop.vars.blockAjaxOpinion=!1,n.classList.remove("load-content")})).catch((()=>{Alertek.Start(app_shop.vars.opinion_error),app_shop.vars.blockAjaxOpinion=!1,n.classList.remove("load-content")})))},app_shop.run((()=>{document.querySelectorAll('#opinion_products textarea[name="opinion"]').forEach((e=>{""!==e.value&&app_shop.fn.opinionSendInfo(e.closest("form"))}));const e=document.querySelectorAll("#opinion_order, #opinion_products"),o=window.URL||window.webkitURL;e.forEach((e=>{e.addEventListener("click",(e=>{const{target:o}=e;if(o.closest(".opinion_star")){e.preventDefault();const n=o.closest(".opinion_star");n.classList.add("active");let i=n.previousElementSibling;for(;i;)i.matches("a")&&i.classList.add("active"),i=i.previousElementSibling;let t=n.nextElementSibling;for(;t;)t.matches("a")&&t.classList.remove("active"),t=t.nextElementSibling;const s=n.parentElement.querySelector("strong"),a=n.parentElement.querySelector("input");s.textContent=n.getAttribute("title"),a.value=n.getAttribute("data-rel");n.closest("form").querySelectorAll(".opinions_points_picture:not(.d-block)").forEach((e=>{e.classList.add("d-block")}))}if(o.closest(".opinion_edit")){e.preventDefault();const n=o.closest("form");n?.classList.remove("--ready");const i=o.closest(".opinion_send");i&&i.remove()}if(o.closest(".f-button button")){e.preventDefault();const n=o.closest("form"),i=n.querySelector('textarea[name="opinion"]');if(!i.value)return Alertek.Start(app_shop.vars.opinion_empty),void i.focus();const t=new FormData(n);t.delete("opinion_photo");let s=new URLSearchParams(t).toString();const a=n.querySelector(".opinion_add_photo");if(a?.value)return void app_shop.fn.encodeImagetoBase64(a,(function(e){const o=encodeURIComponent(e.replace(/data:image\/(jpg|jpeg);base64,/,""));s+=`&picture=${o}`,app_shop.fn.sendOpinionsAjax(n,s)}));app_shop.fn.sendOpinionsAjax(n,s)}})),e.addEventListener("change",(e=>{const{target:n}=e;if(n.closest('input[type="file"]')){const e=n.closest('input[type="file"]'),i=e.files[0],t=new Image;let s=0,a=0;const p=2048,r=1536;t.src=o.createObjectURL(i),t.onload=function(){if(s=this.width,a=this.height,s>p||a>r)return Alertek.Start(app_shop.vars.opinion_file_size),void(e.value="");"image/jpeg"!==i.type&&"image/jpg"!==i.type&&(Alertek.Start(app_shop.vars.opinion_file_type),e.value="")}}}))}))}),"all","#opinion_order"),app_shop.run((()=>{document.querySelectorAll("#opinion_products .opinion_send").forEach((e=>{const o=e.closest("form");if(app_shop.vars.view>2)return void o.appendChild(e);const n=o.querySelector(".opinion_products__block.--opinion");n&&n.appendChild(e)}))}),[1,2,3,4],"#opinion_products");
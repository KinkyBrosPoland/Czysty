class RemarksCOP extends COPModules{constructor(e={}){super(e)}initTitle(){const e=this.remarksElement.querySelector(`.${this.prefix}__title`);e&&"oscop"===this.type&&e.classList.add("--small")}setWcagAttributes(e){e.setAttribute("aria-hidden","true"),e.querySelectorAll("a, button, textarea").forEach((e=>e.setAttribute("tabindex","-1")))}removeWcagAttributes(e){e.removeAttribute("aria-hidden"),e.querySelectorAll("a, button, textarea").forEach((e=>e.removeAttribute("tabindex")))}onClickShowTextarea(e){const t=e.closest(`.${this.prefix}_remarks__item`);if(!t)return;const r=t.querySelector(`.${this.prefix}_remarks__textarea`);if(!r)return;const s=t.querySelector(`.${this.prefix}_remarks__textarea_wrapper`);if(!s)return;const i=t.querySelector(`.${this.prefix}_remarks__text`);if(!i)return;const a=t.querySelector(`.${this.prefix}_remarks__input`);if(!a)return;t.classList.contains("--filled");t.classList.remove("--filled"),t.classList.toggle("--active");return t.classList.contains("--active")?(r.disabled=!1,a.disabled=!1,a.value=r.value,setTimeout((()=>{r.focus()}),200),void this.removeWcagAttributes(s)):""===r.value?(t.classList.remove("--filled"),i.textContent="",a.value="",a.disabled=!0,void this.setWcagAttributes(s)):(t.classList.add("--filled"),i.textContent=r.value,a.value=r.value,a.disabled=!1,void this.setWcagAttributes(s))}onClickSaveRemark(e){const t=e.closest(`.${this.prefix}_remarks__item`);if(!t)return;const r=t.querySelector(`.${this.prefix}_remarks__input`);if(!r)return;const s=t.querySelector(`.${this.prefix}_remarks__textarea`);if(!s)return;const i=t.querySelector(`.${this.prefix}_remarks__text`);if(!i)return;const a=t.querySelector(`.${this.prefix}_remarks__message_wrapper`);if(!a)return;const o=t.querySelector(`.${this.prefix}_remarks__textarea_wrapper`);if(o){if(t.classList.remove("--active"),""===s.value)return t.classList.remove("--filled"),i.textContent="",r.value="",r.disabled=!0,this.setWcagAttributes(a),void this.setWcagAttributes(o);t.classList.add("--filled"),i.textContent=s.value,r.disabled=!1,r.value=s.value,this.removeWcagAttributes(a),this.setWcagAttributes(o)}}onClickRemoveRemark(e){const t=e.closest(`.${this.prefix}_remarks__item`);if(!t)return;const r=t.querySelector(`.${this.prefix}_remarks__input`);if(!r)return;const s=t.querySelector(`.${this.prefix}_remarks__textarea`);if(!s)return;const i=t.querySelector(`.${this.prefix}_remarks__text`);if(!i)return;const a=t.querySelector(`.${this.prefix}_remarks__message_wrapper`);a&&(t.classList.remove("--active","--filled"),s.disabled=!0,s.value="",r.value="",r.disabled=!0,setTimeout((()=>{i.textContent=""}),200),this.setWcagAttributes(a))}onInputRemark(e){const{target:t}=e,r=t.closest(`.${this.prefix}_remarks__item`);if(!r)return;const s=r.querySelector(`.${this.prefix}_remarks__input`);if(!s)return;const i=r.querySelector(`.${this.prefix}_remarks__textarea`);i&&(s.value=i.value)}initEvents(){this.remarksElement.addEventListener("click",(e=>{const{target:t}=e;(t.closest(`.${this.prefix}_remarks__label`)||t.closest(`.${this.prefix}_remarks__link.--edit`))&&(e.preventDefault(),this.onClickShowTextarea(t)),t.closest(`.${this.prefix}_remarks__save`)&&(e.preventDefault(),this.onClickSaveRemark(t)),t.closest(`.${this.prefix}_remarks__link.--remove`)&&(e.preventDefault(),this.onClickRemoveRemark(t))}));this.remarksElement.querySelectorAll(`.${this.prefix}_remarks__textarea`).forEach((e=>{e.addEventListener("input",this.onInputRemark.bind(this))}))}generate(){const e=document.getElementById(`${this.prefix}_remarks_template`)?.content.cloneNode(!0);if(!e||!e.firstChild)return;const t=this.remarksElement;this.remarksElement=e.firstChild,this.initTitle(),this.initEvents(),t&&document.body.contains(t)?t.replaceWith(this.remarksElement):this.move({element:this.remarksElement,...this.vars.move})}init(e={}){this.type=e.type||app_shop.vars.copModulesType||"order1",this.vars={afterReady:e.afterReady||(()=>{}),move:e.move||!1},this.generate(),this.vars.afterReady(this.remarksElement)}}try{app_shop.fn.copModulesRemarks=new RemarksCOP,app_shop.vars.copModulesClasses.push((()=>{app_shop.fn.copModulesRemarks=new RemarksCOP}))}catch(e){window?.errorLog?.(e)}
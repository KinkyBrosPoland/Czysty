app_shop.vars.orderDetailsLiterals={UwagiMogaMiecMaksymalnie:"Uwagi mogą mieć maksymalnie",znakow:"znaków. ",WybranyGratisNieJestDostepny:"<b>Wybrany przez Ciebie wcześniej produkt gratisowy nie jest dostępny dla takiej wartości koszyka.</b><br/><span style='font-weight:normal;'>Prosimy wybierz inny produkt gratisowy lub zmień swoje zamówienie.</span>",max:"Maksymalnie możesz zamówić: ",min:"Minimalnie musisz zamówić ",addDescription:"Dodaj opis lub załącznik",modifyDescription:"Zmień opis lub załącznik",wrapperAdded:"Pomyślnie dodano opakowanie do koszyka",iloscProduktow:"Ilość produktów",potwierdzUsuniecieProduktow:"Potwierdź usunięcie produktów"},app_shop.vars.recoverProductData={};const numberCheckBasketedit=(e,t)=>{const{quantity:a,quantitySizes:r,amount:s,unit_sellby:o,unit:i,unit_precision:n,max_q:l,max_s:c,min_q:p,min_s:u}=e;if(!a)return!1;let d=parseFloat(a);const h=parseFloat(n),m=parseFloat(l),_=parseFloat(c),v=parseFloat(p),b=parseFloat(u),y=parseFloat(parseFloat(o).toFixed(h)),k=1/Math.pow(10,h),f=e=>e%y!==0?f(parseFloat((e+k).toFixed(h))):e.toFixed(h);if(d=parseFloat(f(d)),isNaN(m)&&isNaN(_)&&isNaN(v)&&isNaN(b)&&-1===parseFloat(s))return d;let w=parseFloat(s),g=y,S=-1;return isNaN(m)||(S=m-r,S=S<0?"end":S,w=w>m?m:w),isNaN(_)||(w=w>_?_:w),isNaN(v)||(g=v>g?v:g),isNaN(b)||(g=b>g?b:g),-1!==w&&(g=w>g?g:y),g&&a<g&&0!=a?(Alertek.show_alert(`${t.min} ${Math.ceil(parseFloat(g)/y)*y} ${i}`),Math.ceil(parseFloat(g)/y)*y):"end"===S?(Alertek.show_alert(`${t.max} ${Math.floor(parseFloat(m)/y)*y} ${i}`),Math.floor(parseFloat(m)/y)*y):a>w&&-1!==w?(Alertek.show_alert(`${t.max} ${Math.floor(parseFloat(w)/y)*y} ${i}`),Math.floor(parseFloat(w)/y)*y):a},NumberBySelectBasketedit=function(e){const{selectClass:t,inputClass:a,wrapperClass:r,generateDropdownCallback:s,afterChangeValue:o}=e,i=this;return this.vars={typingTimer:"",doneTypingInterval:10},this.iOS=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,this.dropdownNumberAfterClick=e=>{const t=e.querySelector(".f-dropdown-item"),s=e.closest(r),i=s.querySelector(a);t.hasAttribute("data-more")?(s.classList.add("--more"),i.focus(),i.value=""):(s.classList.remove("--more"),i.value=t.getAttribute("data-value")),o&&o(i)},this.buySelect=()=>new SelectToDropdown({disableMobileView:!!this.iOS(),selector:`${t}`,generateDropdownCallback:s||(()=>{document.querySelectorAll(".buy__number .f-dropdown-toggle").forEach((e=>e.setAttribute("aria-label",app_shop.vars.orderDetailsLiterals?.iloscProduktow)))}),afterClickDropdownCallback:!!this.dropdownNumberAfterClick&&this.dropdownNumberAfterClick}),this.moreInputChange=function(e){clearTimeout(i.vars.typingTimer),i.vars.typingTimer=setTimeout((()=>{""!==e.value&&(e.setAttribute("data-prev",e.value),o&&o(e),app_shop.vars.lastFocusedElement=`#${e.id}`)}),i.vars.doneTypingInterval)},this.moreInputBlur=function(e){return this.value!==this.getAttribute("data-prev")&&((!e.key||"Enter"===e.key)&&(""===this.value&&(this.value=this.getAttribute("data-prev")),void i.moreInputChange(this)))},this.setEvents=()=>{document.querySelectorAll(a).forEach((e=>{e.addEventListener("keyup",this.moreInputBlur),e.addEventListener("blur",this.moreInputBlur)}))},this.init=()=>{this.buySelect(),this.setEvents()},this.init()},Basket=function(e,t){this.params=e;const a=document.querySelector("#Basket"),r=document.querySelector(".basket__form"),s=document.querySelector("#container");this.recoverTime=e?.recoverTime||2e4;const{max:o="",min:i="",maxvalue:n=255,UwagiMogaMiecMaksymalnie:l="",znakow:c="",WybranyGratisNieJestDostepny:p="",iloscProduktow:u="",potwierdzUsuniecieProduktow:d=""}=t;this.setLoader=e=>{e?a.classList.add("--loading"):a.classList.remove("--loading")},this.setAsyncData=async(e,t)=>{try{const a=await fetch(e,{method:"POST",body:t});return await a.text()}catch(e){return!1}},this.createWidthAnimator=(e,t=2e4)=>{if(!e)return!1;let a=null,r=null;const s=o=>{r||(r=o);const i=o-r,n=Math.min(i/t,1),l=100-100*n;e.style.width=l+"%",n<1?a=requestAnimationFrame(s):(e.style.width="0%",a=null)};return{start(){this.stop(),a=requestAnimationFrame(s)},reset(){this.stop(),e.style.width="100%",r=null,pausedTime=null},stop(){a&&(cancelAnimationFrame(a),a=null,null!==r&&(pausedTime=performance.now()-r))}}},this.recoverProduct=(e,t)=>{const a=document.querySelector(".basket__recover_product");if(!a)return!1;a?.classList.add("--show"),a.style.height=`${e}px`,document.querySelectorAll(".basket__block")[t-1]?.insertAdjacentElement("afterend",a),app_shop.vars.recoverAnimator=this.createWidthAnimator(a.querySelector(".progress_bar__value")),app_shop.vars.recoverAnimator.start(),app_shop.vars.recoverProductData.timeout=setTimeout((async()=>{a?.classList.remove("--show")}),this.recoverTime)},this.removeModal=(e,t)=>!(!e||!t)&&(e?void(this.removeModalInstance=new Modal({element:e,classList:"--extrasmall --remove_product",setFocusOnFirstElement:!0,afterShow:()=>{document.querySelector(".modal.--remove_product").setAttribute("aria-label",d),e.querySelector(".remove_modal__close").addEventListener("click",(e=>(e.preventDefault(),this?.removeModalInstance.closeModal(),!1))),e.querySelector(".remove_modal__confirm").addEventListener("click",(e=>(e.preventDefault(),t(),this?.removeModalInstance.closeModal(),!1)))}})):(t(),!1)),this.removeHelper=e=>{if(!e)return!1;e.parentElement?.classList.add("--delete");e.parentElement.querySelector(".buy__more_delete")&&(e.parentElement.querySelector(".buy__more_delete").innerHTML=e.value),e.value=0};const h={addComment:(e,t)=>{t&&(t.querySelector(".--add-comment")?.classList.toggle("--active"),t.querySelector(".--add-comment .add__textarea")?.focus(),t.scrollIntoView({behavior:"smooth",block:"center"}))},addMoreFile:(e,t)=>{const a=t.querySelector(".add__files input").cloneNode(!0);return a.value="",t.querySelector(".add__files").insertAdjacentElement("beforeend",a),!1},previewFile:e=>{const t=e.getAttribute("rel"),a=new Image;return a.src=t,a.onload=function(){Modal({html:`<div id="ui-dialogimg"><img alt="fileName" src="${t}" /></div>`,classList:"--medium"})},!1},remove:async(e,t)=>{if(1===document.querySelectorAll(".basket__block.--product").length)return clearTimeout(app_shop.vars.recoverProductData.timeout),h.removeAll(null,null,null,".remove_modal:not(.--all)"),!1;const a=t.querySelector(".quantity__input");app_shop.vars.recoverProductData.formData=new FormData(r),app_shop.vars.lastFocusedElement=".recover_product",this.removeHelper(a);const s=t.offsetHeight;let o=0;document.querySelectorAll(".basket__block").forEach(((e,a)=>{e===t&&(o=a)})),await this.reloadForm(null),this.recoverProduct(s,o)},recoverProduct:async(e,t)=>{a.querySelectorAll(".basket__block.--product .quantity__input").forEach((e=>{this.removeHelper(e)})),this.setLoader(!0),app_shop.vars.lastFocusedElement=".basket__form",app_shop.vars.recoverAnimator.stop(),await this.updateBasket(),this.reloadForm(null,app_shop.vars.recoverProductData.formData),clearTimeout(app_shop.vars.recoverProductData.timeout)},recoverProductClose:()=>{const e=document.querySelector(".basket__recover_product");if(!e)return!1;e?.classList.remove("--show"),clearTimeout(app_shop.vars.recoverProductData.timeout)},removeAll:(e,t,r,o=".remove_modal.--all")=>{const i=document.querySelector(o);this.removeModal(i,(()=>{a.querySelectorAll(".basket__block.--product .quantity__input").forEach((e=>{this.removeHelper(e)})),this.reloadForm().then((()=>{s.scrollIntoView({behavior:"smooth"})}))})),document.querySelector(".remove_modal__confirm").focus()},blurOnCommentTextarea:(e,t,a)=>{if(e.value.length>n&&(e.value=e.value.substring(0,n),Alertek.show_alert(`${l} ${n} ${c}`)),app_shop.vars.view<3){const t=document.querySelector(".summary.--fixed");if(!t)return;document.activeElement==e?t.classList.add("--hidden"):t.classList.remove("--hidden")}},toggleAllInGroup:e=>{if(e){const t=e.closest(".basket__block").getAttribute("data-group-id");document.querySelectorAll(`.basket__block[data-group-id="${t}"]`).forEach((e=>{e.classList.toggle("--open")}))}},changeQuantity:e=>{const t=e.closest(".basket__block.--product").getAttribute("data-product-id"),a=document.querySelectorAll(`div[data-product-id="${t}"]`),r=Array.from(a).map((e=>{parseFloat(e.querySelector(".quantity__input").value)})).reduce((function(e,t){return e+t})),s=a.length>1?r:e.value,n={...e.dataset,quantity:e.value,quantitySizes:s},l=numberCheckBasketedit(n,{max:o,min:i});if(!l&&0!==l)return!1;e.value=l,this.reloadForm()},reload:(e,t,a)=>(a.preventDefault(),this.reloadForm(),!1)};this.basketEvents=h,this.updateBasket=async e=>{const t=`${r.attributes.action.value}`,a=new FormData(r);return this.data=await this.setAsyncData(t,e||a),!!this.data},this.beforeReloadForm=()=>{this.setLoader(!0),document.querySelector(".cop_summary")?.classList.add("--loading"),document.querySelectorAll(".quantity__input").forEach((e=>{e.blur()}))},this.reloadForm=async(e,t,a=!1)=>{e&&e.preventDefault(),this.beforeReloadForm();a?await this.updateBasket(new FormData(document.createElement("form"))):await this.updateBasket(t);if(clearTimeout(app_shop.vars.recoverProductData.timeout),!this.data)return!1;const r=(new DOMParser).parseFromString(this.data,"text/html"),s=document.querySelector("#content"),o=document.querySelector("#menu_basket"),i=r.querySelector("#content"),n=r.querySelector("#menu_basket");return s.innerHTML=i.innerHTML,o.innerHTML=n.innerHTML,app_shop.fn.evalJSFromHtml(r),window.Klarna?.OnsiteMessaging?.refresh?.(),"function"==typeof this.callbackAjaxLoad&&this.callbackAjaxLoad(r),app_shop.fn.runAjaxFn(),this.setLoader(!1),!0};const m=(t,a)=>{t.forEach((t=>{const r=t.getAttribute("data-event_name")||"click",s=t.getAttribute("data-event_list")?.split(",")?.map((e=>e.trim()))||[],o=t.getAttribute("data-event"),i=h[o],n=`${o}Callback`,l=[r,...s];i&&l.forEach((r=>{t.addEventListener(r,(r=>{i(t,a,r),"function"==typeof e[n]&&e[n]()}))}))}))};return this.setEvents=()=>{const e=a.querySelectorAll(".basket__block.--product");a.querySelectorAll(".basket__block.--product").forEach(((t,a)=>{m(t.querySelectorAll(".--event"),e[a])})),m(a.querySelectorAll(".basket__tools .--event"),0),m(a.querySelectorAll(".basket__recover_product .--event"),0),r.addEventListener("submit",this.reloadForm)},this.giftsCheck=()=>{a.querySelector(".basket__gift_inputs[data-nogiftforyou]")&&(Alertek.show_alert(p),a.querySelectorAll(".basket__gift_inputs input").forEach((e=>{e.removeAttribute("disabled")})),this.reloadForm())},this.init=()=>{this.setEvents(),app_shop.fn.NumberBySelectBasketedit=new NumberBySelectBasketedit({selectClass:".buy__number:not(.f-dropdown)",inputClass:".quantity__input",wrapperClass:".buy",afterChangeValue:h.changeQuantity}),this.giftsCheck(),window?.simple_tooltip(".basket__tip","n59581_tooltip")},this.init()},Wrappers=function(e){const t=e||{element:'a[href="#addWrappers"]',parentEl:".basket__wrappers",showOnClick:!0,linkParentElement:".basket__tools"},a={WybierzOpakowanie:app_shop.txt.WybierzOpakowanie||"Wybierz opakowanie",priceTypeText:app_shop.txt.priceTypeText||"brutto",Gratis:app_shop.txt.Gratis||"Gratis",DodajOpakowanie:app_shop.txt.DodajOpakowanie||"Dodaj opakowanie"};this.txt=a;const{element:r,parentEl:s,linkParentElement:o,showOnClick:i}=t,n=(app_shop.vars.priceType,e.afterClickCall?e.afterClickCall:()=>{}),l=e.afterAppendCall?e.afterAppendCall:()=>{},c=e.afterGetCall?e.afterGetCall:()=>{};this.getWrappers=async()=>{const e=JSON.stringify({query:"query {\n          wrappers {\n            name\n            type\n            icon\n            sizeId\n            productId\n            quantity\n                price {\n                    gross {\n                      value\n                      formatted\n                    }\n                    net {\n                      formatted\n                    }\n                }\n          }\n          }"});try{const t=await fetch(app_shop.urls.graphql,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:e}),a=await t.json();return c(a),a.data?a.data:{}}catch(e){return{}}},app_shop.graphql.getWrappers=this.getWrappers,this.setWrappers=e=>{if(null===e?.wrappers)return!1;let t="";e?.wrappers?.forEach((e=>t+=function(e){return this.el=e,this.createIcon=()=>`\n          <span class="basketProducts__icon">\n            <img src="${e.icon}" alt="${e.name}"/>\n          </span>`,this.createName=()=>`\n          <span class="basketProducts__name">${e.name}</span>`,this.createPrice=()=>`\n          <div class="basketProducts__price">${e.price.gross.value>0?this.getPriceType():a.Gratis}</div>`,this.getPriceType=()=>`<span class="basketProducts__price_value">${"net"===app_shop.vars.priceType?e.price.net.formatted:e.price.gross.formatted}</span>${a.priceTypeText}`,this.createButtons=()=>`\n          <form action="/basketchange.php" class="basketProducts__buttons">\n            <input type="hidden" name="product" value="${e.productId}" />\n            <input type="hidden" name="size" value="${e.sizeId}" />\n            <input type="hidden" name="mode" value="1" />\n            <input type="hidden" name="number" value="1" />\n            <button href="#basketWrapperAdd" class="basketProducts__action --add" aria-label="${a.DodajOpakowanie}"></button>\n          </form>`,this.createPrices=()=>`\n          <div class="basketProducts__prices">${this.createPrice()+this.createButtons()}</div>`,`\n          <div class="basketProducts__product">\n            ${this.createIcon()+this.createName()+this.createPrices()}\n          </div>`}(e)));return this.wrappers=`\n        <div id="wrappers" class="basketWrappers">\n        \n        <div class="headline"><span class="headline__name">${a.WybierzOpakowanie}</span></div>\n      <div class="basketProducts"><div class="basketProducts__wrapper">${t}</div></div>\n        </div>`,!0},this.buildCache=async()=>(sessionStorage.getItem("basketWrappers")?this.data=JSON.parse(sessionStorage.getItem("basketWrappers")):(this.data=await this.getWrappers(),sessionStorage.setItem("basketWrappers",JSON.stringify(this.data))),null!==this.data?.wrappers&&0!==Object.keys(this.data).length&&this.setWrappers(this.data)),this.appendElement=()=>{document.querySelector(s)?.insertAdjacentHTML("afterbegin",this.wrappers),l(this.data,this.wrappers)},this.setEvents=()=>{document.querySelector(r)?.addEventListener("click",(e=>{if(e.preventDefault(),document.querySelector(o)?.classList.remove("--wrappers"),void 0===this.wrappers)return!1;n(this.data,this.wrappers),this.appendElement(this.wrappers),this.attachAjaxWrappers(),this.scrollIntoWrappers()}))},this.scrollIntoWrappers=()=>{const e=document.querySelector(s);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.querySelector("button")?.focus())},this.pushWrappers=()=>{document.querySelector(o)?.classList.add("--wrappers"),i?this.setEvents():this.appendElement()},this.attachAjaxWrappers=()=>{document.querySelectorAll(".basketProducts__action").forEach((e=>{this.attachAjaxWrapperElement(e)}))},this.attachAjaxWrapperElement=e=>{e.addEventListener("click",(e=>{if(e.target.closest(".basketProducts__action")){const t=document.querySelector("#Basket .basket__wrappers");if(t?.contains(e.target)){e.preventDefault();const t=e.target.closest("form.basketProducts__buttons"),a=new FormData(t);a.append("change","add");const r=[...a.entries()].map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),s=`/basketchange.php${r?`?${r}`:""}`;app_shop.fn.basket.setLoader(!0),fetch(s,{method:"get"}).then((()=>{app_shop.fn.basket.reloadForm(),Alertek.Success(app_shop.vars.orderDetailsLiterals.wrapperAdded)})).catch((e=>{app_shop.fn.basket.setLoader(!1)}))}}}))},this.hideWrappers=()=>{document.querySelector(o)?.classList.remove("--wrappers")},this.init=async()=>{try{await this.buildCache()?this.pushWrappers():this.hideWrappers()}catch(e){this.hideWrappers()}}};app_shop.run((async function(){try{const e={element:'a[href="#addWrappers"]',parentEl:".basket__wrappers",showOnClick:!0,linkParentElement:".basket__tools"};app_shop.fn.basketWrappers=new Wrappers(e),await app_shop.fn.basketWrappers.init()}catch(e){window?.errorLog?.(e)}}),"all",".basket__wrappers",!0),app_shop.run((function(){try{app_shop.fn.basket=new Basket({},app_shop.vars.orderDetailsLiterals)}catch(e){window?.errorLog?.(e)}}),"all","#Basket",!0);